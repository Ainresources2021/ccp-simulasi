<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi CCP: Proses Makanan Beku</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7f9;
            color: #333;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #00796b; /* Warna tema HACCP */
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        main {
            display: flex;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 20px auto;
            gap: 20px;
            padding: 0 20px;
        }

        #simulation-visual {
            width: 100%;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        .flow-diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
            padding: 10px;
            background-color: #f0f8ff;
            border-radius: 6px;
            overflow-x: auto;
        }

        .diagram-step {
            background-color: #00796b;
            color: white;
            padding: 10px 15px;
            margin: 0 5px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 80px;
            text-align: center;
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
            transition: all 0.3s;
        }

        .diagram-step.cook { background-color: #d32f2f; }
        .diagram-step.cool { background-color: #1976d2; }

        .diagram-step.is-ccp {
            border-color: #d32f2f;
            box-shadow: 0 0 12px #d32f2f;
        }
        .diagram-step.not-ccp {
            border-color: #4caf50;
        }

        .arrow {
            font-size: 24px;
            color: #00a090;
            margin: 0 5px;
        }

        .visual-note {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }

        #process-flow {
            flex: 2;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .process-step {
            border: 1px solid #ddd;
            border-left: 5px solid #00a090;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
            background-color: #f8f9fa;
            transition: all 0.3s;
        }
        
        .process-step-active {
            border-left-color: #ffb300;
            background-color: #fffde7;
        }

        .process-step h3 {
            color: #00796b;
            margin-top: 0;
        }

        .analyze-btn {
            background-color: #ffb300;
            color: #333;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 4px;
            margin-top: 10px;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .analyze-btn:hover {
            background-color: #ffc107;
        }

        #ccp-decision-tree {
            flex: 1;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border: 1px solid #00796b;
        }

        #tree-questions {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed #ccc;
        }

        .question-container {
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
        }

        .question-container p {
            margin: 0 0 10px 0;
        }

        .question-container button {
            margin-right: 10px;
            padding: 8px 15px;
            cursor: pointer;
            border: 1px solid #00796b;
            background-color: #e0f2f1;
            border-radius: 4px;
            font-weight: 500;
        }

        .question-container button:hover {
            background-color: #b2dfdb;
        }
        .question-container button:disabled {
            background-color: #e0e0e0;
            cursor: not-allowed;
            border-color: #9e9e9e;
        }
        
        /* Gaya untuk maklum balas */
        .feedback-container {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-size: 0.9em;
            display: none; /* Sembunyi secara lalai */
        }
        .feedback-correct {
            display: block;
            background-color: #e8f5e9;
            border: 1px solid #4caf50;
            color: #1b5e20;
        }
        .feedback-wrong {
            display: block;
            background-color: #ffcdd2;
            border: 1px solid #f44336;
            color: #b71c1c;
        }


        #ccp-result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            min-height: 50px;
            text-align: center;
            font-weight: bold;
            color: white;
        }
        
        .result-ccp {
            background-color: #d32f2f; 
        }

        .result-not-ccp {
            background-color: #4caf50;
        }

        footer {
            background-color: #e0e0e0;
            text-align: center;
            padding: 15px;
            margin-top: 20px;
            width: 100%;
        }

    </style>
</head>
<body>

    <header>
        <h1>Simulasi Pencarian Titik Kawalan Kritikal (CCP)</h1>
        <p>Proses: Pembuatan Makanan Beku (Cth: Nasi Goreng Beku)</p>
    </header>

    <main>
        <section id="simulation-visual">
            <h2>Garis Masa Aliran Proses</h2>
            <div class="flow-diagram">
                <div id="diagram-1" class="diagram-step">üì¶ Terima</div>
                <div class="arrow">‚Üí</div>
                <div id="diagram-2" class="diagram-step">‚ùÑÔ∏è Simpan Sejuk</div>
                <div class="arrow">‚Üí</div>
                <div id="diagram-3" class="diagram-step cook">üî• Masak</div>
                <div class="arrow">‚Üí</div>
                <div id="diagram-4" class="diagram-step cool">üßä Sejukkan</div>
                <div class="arrow">‚Üí</div>
                <div id="diagram-5" class="diagram-step">üõçÔ∏è Bungkus</div>
                <div class="arrow">‚Üí</div>
                <div id="diagram-6" class="diagram-step">üöõ Edar</div>
            </div>
             <p class="visual-note">(*Setiap langkah akan dinilai untuk menentukan status CCPnya.)</p>
        </section>
        
        <div id="process-flow">
            <h2>Aliran Proses & Analisis Bahaya</h2>
            <div class="process-step" data-step="1">
                <h3>1. Penerimaan Bahan Mentah</h3>
                <p>Menerima daging, sayur, dan pembungkusan. Bahaya: Mikrobiologi, Kimia.</p>
                <button class="analyze-btn" onclick="startAnalysis(1)">Analisis CCP</button>
            </div>
            <div class="process-step" data-step="2">
                <h3>2. Penyimpanan Sejuk Beku</h3>
                <p>Menyimpan bahan sensitif (daging/sayur) dalam suhu terkawal. Bahaya: Pertumbuhan bakteria jika suhu tak stabil.</p>
                <button class="analyze-btn" onclick="startAnalysis(2)">Analisis CCP</button>
            </div>
            <div class="process-step" data-step="3">
                <h3>3. Memasak/Pemanasan</h3>
                <p>Memasak komponen utama untuk mencapai suhu teras minimum. Bahaya: Kelangsungan hidup patogen.</p>
                <button class="analyze-btn" onclick="startAnalysis(3)">Analisis CCP</button>
            </div>
            <div class="process-step" data-step="4">
                <h3>4. Penyejukan Pantas</h3>
                <p>Menurunkan suhu produk yang dimasak dengan cepat. Bahaya: Pertumbuhan spora/patogen.</p>
                <button class="analyze-btn" onclick="startAnalysis(4)">Analisis CCP</button>
            </div>
            <div class="process-step" data-step="5">
                <h3>5. Pembungkusan & Pembekuan</h3>
                <p>Pembungkusan dan pembekuan ke suhu < -18¬∞C. Bahaya: Pembungkusan rosak, Suhu tidak cukup sejuk.</p>
                <button class="analyze-btn" onclick="startAnalysis(5)">Analisis CCP</button>
            </div>
            <div class="process-step" data-step="6">
                <h3>6. Penyimpanan Akhir & Pengedaran</h3>
                <p>Menyimpan produk beku sebelum dihantar. Bahaya: Pencairan/Kenaikan suhu.</p>
                <button class="analyze-btn" onclick="startAnalysis(6)">Analisis CCP</button>
            </div>
        </div>

        <div id="ccp-decision-tree">
            <h2>üîç Pokok Keputusan CCP</h2>
            <div id="current-step-info"></div>
            <div id="tree-questions">
                 <p>Pilih 'Analisis CCP' di sebelah kiri untuk memulakan penilaian bagi setiap langkah proses.</p>
            </div>
            <div id="ccp-result"></div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Simulasi Pendidikan CCP</p>
    </footer>

    <script>
        // Data lengkap untuk setiap langkah termasuk jawapan betul dan maklum balas yang berbeza
        const decisionPaths = {
            1: { name: "Penerimaan Bahan Mentah", path: [
                { qId: 1, correct: true, feedbackCorrect: "Betul. Kawalan seperti pembekal yang diluluskan mesti ada.", feedbackWrong: "Salah. Mesti ada kawalan untuk bahan mentah, contohnya hanya menerima dari pembekal yang diluluskan." },
                { qId: 3, correct: true, feedbackCorrect: "Betul. Tanpa kawalan suhu, bakteria pada bahan mentah boleh membiak.", feedbackWrong: "Salah. Pencemaran daripada bahan mentah itu sendiri adalah risiko yang signifikan jika tidak dikawal." },
                { qId: 4, correct: true, feedbackCorrect: "Tepat. Langkah memasak (CCP) yang akan datang akan menghapuskan bahaya mikrobiologi ini.", feedbackWrong: "Salah. Untuk produk ini, langkah memasak selepas ini direka untuk membunuh patogen. Oleh itu, langkah ini bukan CCP." }
            ], result: 5 },
            2: { name: "Penyimpanan Sejuk Beku", path: [
                { qId: 1, correct: true, feedbackCorrect: "Betul. Kawalan suhu adalah langkah kawalan kritikal di sini.", feedbackWrong: "Salah. Penyimpanan sejuk mesti mempunyai kawalan suhu yang dipantau." },
                { qId: 3, correct: true, feedbackCorrect: "Betul. Jika suhu gagal, bakteria boleh tumbuh ke tahap berbahaya.", feedbackWrong: "Salah. Kegagalan kawalan suhu boleh menyebabkan pertumbuhan bakteria yang signifikan." },
                { qId: 4, correct: true, feedbackCorrect: "Tepat. Langkah memasak seterusnya akan menguruskan sebarang pertumbuhan bakteria.", feedbackWrong: "Salah. Langkah memasak selepas ini akan menghapuskan bahaya. Oleh itu, penyimpanan sejuk bukan CCP." }
            ], result: 5 },
            3: { name: "Memasak/Pemanasan", path: [
                { qId: 1, correct: true, feedbackCorrect: "Betul. Haba (suhu dan masa) adalah langkah kawalan.", feedbackWrong: "Salah. Proses memasak itu sendiri adalah satu langkah kawalan." },
                { qId: 2, correct: true, feedbackCorrect: "Tepat! Ini adalah tujuan utama memasak, untuk membunuh patogen dan menjadikannya selamat.", feedbackWrong: "Salah. Memasak direka KHUSUS untuk tujuan ini, menjadikannya satu CCP." }
            ], result: 6 },
            4: { name: "Penyejukan Pantas", path: [
                { qId: 1, correct: true, feedbackCorrect: "Betul. Mengawal masa dan suhu penyejukan adalah langkah kawalan.", feedbackWrong: "Salah. Proses penyejukan pantas adalah satu langkah kawalan." },
                { qId: 2, correct: true, feedbackCorrect: "Tepat! Ia direka khusus untuk mengelakkan spora bakteria daripada tumbuh.", feedbackWrong: "Salah. Penyejukan pantas direka KHUSUS untuk mengawal bahaya ini, menjadikannya satu CCP." }
            ], result: 6 },
            5: { name: "Pembungkusan & Pembekuan", path: [
                { qId: 1, correct: true, feedbackCorrect: "Betul. Prosedur pembungkusan yang betul dan pemeriksaan integriti adalah satu kawalan.", feedbackWrong: "Salah. Mesti ada kawalan untuk memastikan pembungkusan tidak rosak atau tercemar." },
                { qId: 3, correct: false, feedbackCorrect: "Tepat. Jika Amalan Pengilangan Baik (GMP) dipatuhi, risiko pencemaran di sini adalah rendah.", feedbackWrong: "Salah. Walaupun pencemaran boleh berlaku, ia tidak mungkin meningkat ke tahap *tidak boleh diterima* jika GMP diamalkan. Jadi ia bukan CCP." }
            ], result: 5 },
            6: { name: "Penyimpanan & Pengedaran", path: [
                { qId: 1, correct: true, feedbackCorrect: "Betul. Kawalan suhu semasa penyimpanan dan pengedaran adalah penting.", feedbackWrong: "Salah. Mesti ada kawalan suhu untuk mengekalkan keadaan beku." },
                { qId: 3, correct: true, feedbackCorrect: "Betul. Jika rantaian sejuk terputus, produk boleh menjadi tidak selamat.", feedbackWrong: "Salah. Kenaikan suhu boleh menyebabkan produk cair dan pertumbuhan mikrob." },
                { qId: 4, correct: false, feedbackCorrect: "Tepat. Tiada langkah seterusnya. Namun, ini bukan CCP kerana bahaya kritikal (patogen) telah dikawal di langkah memasak & penyejukan.", feedbackWrong: "Salah. Tiada langkah seterusnya untuk pengguna komersial. Kawalan berada di tangan pengguna, tetapi langkah ini sendiri bukan CCP dalam proses ini." }
            ], result: 5 }
        };

        const ccpQuestions = {
            1: { text: "S1: Adakah langkah kawalan pencegahan wujud untuk bahaya yang dikenal pasti?" },
            2: { text: "S2: Adakah langkah ini direka khusus untuk menghapuskan atau mengurangkan bahaya ke tahap yang boleh diterima?" },
            3: { text: "S3: Mungkinkah pencemaran berlaku atau meningkat ke tahap yang tidak boleh diterima?" },
            4: { text: "S4: Adakah langkah susulan akan menghapuskan atau mengurangkan bahaya ke tahap yang boleh diterima?" }
        };

        const ccpResults = {
            5: { text: "<strong>BUKAN CCP</strong>", type: 'Not CCP', justification: "Langkah ini tidak mengawal bahaya utama atau bahaya tersebut akan dikawal di langkah lain." },
            6: { text: "<strong>TITIK KAWALAN KRITIKAL (CCP)!</strong>", type: 'CCP', justification: "Ini adalah langkah kritikal untuk mencegah, menghapuskan, atau mengurangkan bahaya ke tahap yang selamat." }
        };

        let currentStep = null;
        let questionIndex = 0;
        
        const treeQuestionsDiv = document.getElementById('tree-questions');
        const ccpResultDiv = document.getElementById('ccp-result');
        const stepInfoDiv = document.getElementById('current-step-info');

        function startAnalysis(stepNumber) {
            currentStep = stepNumber;
            questionIndex = 0;
            ccpResultDiv.innerHTML = '';
            ccpResultDiv.className = '';
            
            document.querySelectorAll('.process-step').forEach(el => el.classList.remove('process-step-active'));
            document.querySelector(`.process-step[data-step="${stepNumber}"]`).classList.add('process-step-active');
            
            stepInfoDiv.innerHTML = `<p>Anda sedang menganalisis: <strong>${decisionPaths[currentStep].name}</strong></p>`;
            displayQuestion();
        }

        function displayQuestion() {
            const path = decisionPaths[currentStep].path;
            if (questionIndex >= path.length) {
                displayResult();
                return;
            }

            const currentQuestionInfo = path[questionIndex];
            const questionText = ccpQuestions[currentQuestionInfo.qId].text;

            treeQuestionsDiv.innerHTML = `
                <div class="question-container">
                    <p><strong>${questionText}</strong></p>
                    <div>
                        <button onclick="handleAnswer(true)">YA</button>
                        <button onclick="handleAnswer(false)">TIDAK</button>
                    </div>
                    <div class="feedback-container"></div>
                </div>
            `;
        }

        function handleAnswer(userAnswer) {
            const path = decisionPaths[currentStep].path;
            const questionInfo = path[questionIndex];
            const isCorrect = userAnswer === questionInfo.correct;
            
            const feedbackDiv = treeQuestionsDiv.querySelector('.feedback-container');
            
            // Pilih maklum balas yang betul
            feedbackDiv.innerHTML = isCorrect ? questionInfo.feedbackCorrect : questionInfo.feedbackWrong;
            
            feedbackDiv.className = isCorrect ? 'feedback-container feedback-correct' : 'feedback-container feedback-wrong';

            // Lumpuhkan butang selepas menjawab
            treeQuestionsDiv.querySelectorAll('button').forEach(btn => btn.disabled = true);

            // Teruskan ke soalan seterusnya atau tunjukkan keputusan selepas 5 saat
            setTimeout(() => {
                questionIndex++;
                displayQuestion();
            }, 5000);
        }

        function displayResult() {
            const diagramStep = document.getElementById(`diagram-${currentStep}`);
            diagramStep.classList.remove('is-ccp', 'not-ccp');

            const resultId = decisionPaths[currentStep].result;
            const result = ccpResults[resultId];

            ccpResultDiv.className = result.type === 'CCP' ? 'result-ccp' : 'result-not-ccp';
            ccpResultDiv.innerHTML = `<h4>${result.text}</h4><p>${result.justification}</p>`;
            
            diagramStep.classList.add(result.type === 'CCP' ? 'is-ccp' : 'not-ccp');
            
            treeQuestionsDiv.innerHTML = `<p>Analisis untuk <strong>${decisionPaths[currentStep].name}</strong> telah selesai.</p>`;
        }
    </script>
</body>
</html>


